---
layout:     post                                # 使用的布局（不需要改）
title:      一口气完成Pytorch深度学习环境搭建     # 标题 
subtitle:   沐浴Anaconda的恩泽                   #副标题
date:       2020-01-22                          # 时间
author:     zhaiyunfan                          # 作者
header-img: img/post-cover-Pytorch.jpg          #这篇文章标题背景图片
catalog: true                                   # 是否归档
tags:                                           #标签
    - 深度学习
    - 教程
    - Python
    - Anaconda
    - Pytorch
---
## 前言

时间来到21世纪的第二个十年，*Python*凭借着其简单明了的语法和众多像*numpy一样*优秀的包已成为了数据科学工作者最喜爱的工具语言之一。当然，机器学习与深度学习等领域也不例外，本文从*Anaconda*(一个用于科学计算的*Python*发行版)的安装配置起，一路手把手教你如何配置属于你的*Pytorch*环境。你可以在本文结尾学会如何把你的*Pycharm*——一款久经考验的*IDE*——和你的*Anaconda*联系在一起；如果你愿意更进一步的话，你大概可以在下篇博文中邂逅*Jupyter Notebook*，感受一种全新的书写体验

### Anaconda简介

*Python*有着数量庞大的用于科学计算与数据分析的扩展包，只用*pip*指令逐个安装并管理他们之间的依赖关系是一件很困难的任务。同时，对于不同的目标，我们可能会需要不同版本、不同包搭配的*Python*，要为每一个版本单独创建一个虚拟机吗？*Anaconda*给出了否定的答案。*Anaconda*是一个用于科学计算的*Python*发行版，支持*Linux*，*Mac*，*Windows*，包含了众多流行的科学计算、数据分析的*Python*包。在它的帮助下，你可以很轻松的安装并配置众多*Python*包，同时拥有互不冲突的多套*Python*生产环境，并在他们之间迅速切换。具体来说：

>如果你需要的包要求不同版本的*Python*，你无需切换到不同的环境，因为*conda*同样是一个环境管理器。仅需要几条命令，你可以创建一个完全独立的环境来运行不同的*Python*版本，同时继续在你常规的环境中使用你常用的*Python*版本。

因此，在这篇教程中，我会用它安装并配置我的生产环境

### Pytorch简介

[Pytorch](https://pytorch.org/)是一个的开源机器学习框架。2017年1月，*Facebook人工智能研究院*基于*Torch*推出了*PyTorch*。它既可以看作加入了*GPU*支持的*numpy*，同时也可以看成一个拥有自动求导功能的强大的深度神经网络。凭借着众多远胜于它众多竞争者——如*Tensorflow*和*MXNet*——的众多特性，现已在学界被大量应用。机器学习本质上是个数学问题，*Pytorch*等框架中封装良好的数学工具已极大的降低了其准入门槛与学习难度。不但如此，*Pytorch*有着对*GPU*的良好支持，只要你已经安装好*NVIDIA*公司提供的*CUDA*模块，修改一行代码，你就可以把你的代码在*CPU*和*GPU*上无痛切换，全仰赖于*Pytorch*优秀的设计。因此，在这篇教程中，我选用它配合我的学习工作

## 正文

### 安装配置Anaconda

#### 安装Anaconda

我们首先安装*Anaconda*

*Anaconda*有着它自己的[官网](https://www.anaconda.com/)，但鉴于国内复杂的网络环境，我们并不敢保证每个人都可以从它上面跑满带宽下载*Anaconda*安装包，所以我们这里选择[清华大学开源软件镜像站](https://mirror.tuna.tsinghua.edu.cn/)提供的[下载地址](https://mirrors.tuna.tsinghua.edu.cn/anaconda/archive/)。你可以在此站点找到最新的*Anaconda*安装包，截止文章成文时，最新的版本为[Anaconda3-2019.10-Windows-x86_64.exe](https://mirrors.tuna.tsinghua.edu.cn/anaconda/archive/Anaconda3-2019.10-Windows-x86_64.exe)，这是一个64位的*Windows*版本，如果你使用*Linux*或*MacOSX*，你可以自行下载对应的版本，此处不再赘述

一般如果你的C盘空间足够充裕 ~~默认安装完成后大概会占用6GB空间，随着使用和安装新包，这个数字可能增长到十数GB~~ ，你可以直接一路单击**NEXT**直接应用默认选项安装

需要注意的是，不论你在安装过程中选择**为所有用户安装**还是**仅为本用户安装**，你都需要严格控制你的安装路径满足以下两条原则：

1. **绝对不要包含中文**

2. **绝对不要包含空格**

3. **绝对不能包含unicode编码的字符**

![安装路径截图](http://123.57.11.126/sym/49c4caf1be5c2acdc6556918cfe435584d339df005cb0d5982186a9a56a16176.jpg)

所以如上图一般我们可以选择**为所有用户安装**，并直接安装在*C:\ProgramData\Anaconda3*目录下，

在安装过程中，还有以下界面值得注意：

![PATH实例截图](http://123.57.11.126/sym/eb37df49f90d7e0b908cc3b31e73f9466d5de31e1b28c5dffbec57976acebf3e.jpg)

而后是上面这两个选项：

第一个*Add Anaconda to my PATH environment variable*指是否把*Anaconda*加入环境变量，这涉及到能否直接在*cmd*中使用*conda、jupyter、ipython*等命令如果你希望直接在*cmd*中使用*Anaconda*，可以勾选，如果你担心更改环境变量会影响到其他程序对*Python*的调用，那么可以不勾选，同时可以在有需求时使用*Anaconda*提供的命令行工具进行操作。事实上由于*Anaconda*自带的命令行可以显示图表，功能更强，我推荐你不勾选此项，平时直接启动*Anaconda Prompt*来操作*Anaconda*

第二个*Register Anaconda as my default Python*指是否设置*Anaconda*所带的*Python*为系统默认的*Python*版本，如果你没有安装过*Python*或者没有客制化过你自己之前的*Python*，可以直接勾选，如果你希望经常使用自己之前的*Python*，可以不勾选这个选项，取决于你的需求

除此之外就没有什么太值得说的地方了，一路**NEXT**你就可以完成你的安装，之后如果你已经将其添加到了环境变量，可以打开你的*cmd*，输入：

    conda --version

如果返回类似：

    conda 4.7.12

的字样，则证明你已经安装成功了

如果你没有添加环境变量，可以在开始菜单中找到*Anaconda Prompt (Anaconda3)*这个软件，它是*Anaconda*自带的命令行，打开后输入：

    conda list

如果正常的返回了自带的包的列表，则证明你已经安装成功了，我们稍后再进一步介绍*Anaconda*开始菜单文件夹的其余软件的用途

#### 配置Anaconda

在安装完成之后，你还需要进一步配置才能安装你的*Pytorch*

因为*Anaconda*提供的服务器在国外，如果你是国内用户，首先需要更换*Anaconda*来获取快速的包下载安装体验

同样是应用清华镜像，你可以直接通过命令修改源，但这里更推荐直接修改.condarc文件来换源。*Windows*用户无法直接创建名为*.condarc*的配置文件，先在命令行中执行：

    conda config --set show_channel_urls yes

生成该文件之后在你的当前用户目录下找到.condarc文件，用记事本或*Vscode*在其中插入以下内容：

    channels:
    - defaults
    show_channel_urls: true
    default_channels:
    - https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main
    - https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free
    - https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/r
    custom_channels:
    conda-forge: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud
    msys2: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud
    bioconda: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud
    menpo: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud
    pytorch: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud
    simpleitk: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud

保存后即修改完成

## 后记

>zhaiyunfan 2020-01-22 23:45
